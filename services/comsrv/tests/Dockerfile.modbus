FROM python:3.11-slim

# 设置工作目录
WORKDIR /app

# 复制文件
COPY modbus_simulator.py modbus_server_simulator.py modbus_tcp_server.py ./

# 安装pymodbus，不使用代理
RUN unset http_proxy https_proxy HTTP_PROXY HTTPS_PROXY && \
    pip install --no-cache-dir pymodbus==3.6.9

# 暴露端口
EXPOSE 5502 5503

# 启动命令
CMD ["python", "modbus_simulator.py", "--address", "0.0.0.0", "--port", "5502"]