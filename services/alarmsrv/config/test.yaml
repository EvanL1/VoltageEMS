# Test configuration for alarmsrv
# This configuration is used for integration tests

redis:
  connection_type: tcp
  host: localhost
  port: 6379
  database: 15  # Use separate database for tests

api:
  host: 127.0.0.1
  port: 0  # Use 0 to get random available port

storage:
  retention_days: 7
  auto_cleanup: false  # Disable auto cleanup in tests
  cleanup_interval_hours: 24

monitoring:
  enabled: false  # Disable monitoring by default in tests
  channels:
    - 1001
  point_types:
    - "m"  # measurement
    - "s"  # signal
  scan_interval: 1  # Fast scan for tests

alarm_rules:
  - id: "test_temp_high"
    name: "Temperature High"
    description: "Temperature exceeds threshold"
    channel_id: 1001
    point_type: "m"
    point_id: 10001
    enabled: true
    rule_type:
      type: "threshold"
      high: 80.0
      low: 20.0
      high_high: 90.0
      low_low: 10.0

  - id: "test_comm_timeout"
    name: "Communication Timeout"
    description: "Device communication timeout"
    channel_id: 1001
    point_type: "s"
    point_id: 20001
    enabled: true
    rule_type:
      type: "timeout"
      warning_timeout: 300  # 5 minutes
      major_timeout: 600    # 10 minutes
      critical_timeout: 1200 # 20 minutes

  - id: "test_state_change"
    name: "State Change Detection"
    description: "Detect state changes"
    channel_id: 1001
    point_type: "s"
    point_id: 30001
    enabled: true
    rule_type:
      type: "state_change"
      normal_state: false
      alarm_on_change: true