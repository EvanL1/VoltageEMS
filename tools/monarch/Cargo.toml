[package]
name = "monarch"
version = "0.1.0"
edition = "2021"
license.workspace = true

[dependencies]
voltage-rtdb = { path = "../../libs/voltage-rtdb" }
voltage-routing = { path = "../../libs/voltage-routing" }
voltage-rules = { path = "../../libs/voltage-rules" }
# voltage-comlink removed - types moved to comsrv
common = { path = "../../libs/common" }

# Service libraries (lib mode)
comsrv = { path = "../../services/comsrv", default-features = false, optional = true }
modsrv = { path = "../../services/modsrv", default-features = false, optional = true }
# rules have been merged into modsrv (port 6002)

# CLI
clap = { workspace = true }

# Async runtime
tokio = { workspace = true }

# Database
# Use sqlx with SQLite only and rustls runtime to avoid OpenSSL for MUSL builds
sqlx = { workspace = true, default-features = false, features = [
    "sqlite", "chrono", "json", "uuid", "macros", "runtime-tokio-rustls"
] }

# Serialization
serde = { workspace = true }
serde_json = { workspace = true }
serde_yaml = { workspace = true }
csv = { workspace = true }

# Error handling
anyhow = { workspace = true }
thiserror = { workspace = true }

# Logging
tracing = { workspace = true }
tracing-subscriber = { workspace = true }

# File system
tempfile = { workspace = true }

# Output formatting
colored = { workspace = true }
# indicatif removed - not currently used

# Interactive REPL
rustyline = "15"

# TUI dashboard
ratatui = "0.29"
crossterm = "0.28"

# HTTP client
reqwest = { workspace = true }

[features]
default = ["lib-mode"]
lib-mode = ["comsrv", "modsrv"]  # rules merged into modsrv

[lints]
workspace = true
